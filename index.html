<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Korone Down Meter</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link rel="stylesheet" href="style.css" />
  <!-- Chart.js CDN for simple graphs -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
  <main class="container">
    <header class="header">
      <div class="logo-wrap">
        <img id="logo" src="logo.png" alt="Korone Logo" onerror="this.style.display='none'"/>
      </div>

      <div class="title-wrap">
        <h1>Korone Down Meter</h1>
        <p class="sub">Monitor a site for "down" signs and track occurrences</p>
      </div>
    </header>

    <section class="status-card">
      <div class="status-row">
        <div class="status-left">
          <div class="label">Current status</div>
          <div id="status" class="status unknown">Checking…</div>

          <div class="label small">Last checked</div>
          <div id="lastChecked">—</div>

          <div class="label small">Detection phrase</div>
          <input id="phraseInput" type="text" value="site is currently down" />
        </div>

        <div class="status-right">
          <div class="label">Down count</div>
          <div id="count" class="count">0</div>
        </div>
      </div>

      <div class="meta-row">
        <div class="meta-item fullwidth">
          <div class="label">Target URL</div>
          <input id="targetInput" type="text" placeholder="https://example.com/" value="https://pekora.zip" />
          <div class="hint">Set the page to monitor (protocol required)</div>
        </div>
      </div>

      <div class="controls">
        <button id="checkBtn">Check now</button>
        <button id="resetBtn" class="danger">Reset</button>
        <button id="forceIncrementBtn">Force +1</button>
        <button id="exportBtn">Export History</button>
      </div>

      <div class="proxy-area">
        <label class="label">CORS proxy (optional)</label>
        <input id="proxyInput" type="text" placeholder="https://api.allorigins.win/raw?url=" />
        <div class="hint">If cross-origin fetches fail, set a CORS proxy here (or leave blank to auto-try built-in proxies).</div>
        <div class="proxy-actions">
          <button id="testProxyBtn">Test proxy</button>
        </div>
      </div>

      <div class="graph-area">
        <canvas id="historyChart" height="120"></canvas>
      </div>

      <details class="debug" id="debugPanel">
        <summary>Debug / last fetch details</summary>
        <pre id="debug">No debug information yet.</pre>
      </details>
    </section>

    <footer class="footer">
      <small>
        This is a static GitHub Pages site. The script attempts to fetch the target page and look for the configured detection phrase.
        The page will try direct fetches first and then fall back to public CORS proxies automatically. Check the debug panel for details.
      </small>
    </footer>
  </main>

  <script src="script.js"></script>
</body>
</html>
